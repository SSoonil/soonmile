<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sist.web.dao.UserDao">
	<!-- 유저 resultMap -->
	<resultMap type="com.sist.web.model.User" id="userResultMap">
		<id column="USER_ID" property="userId" />
		<result column="USER_PWD" property="userPwd" />
		<result column="USER_NAME" property="userName" />
		<result column="USER_PHONE" property="userPhone" />
		<result column="USER_PROFILE" property="userProfile" />
		<result column="STATUS" property="status" />
		<result column="REG_DATE" property="regDate" />
		<result column="UPDATE_DATE" property="updateDate" />
		<result column="LAST_LOGIN_DATE" property="lastLoginDate" />
		<result column="USER_EMAIL" property="userEmail" />
	</resultMap>
	
	<select id="userSelect" parameterType="String" resultMap="userResultMap">
		SELECT USER_ID,
			   NVL(USER_PWD, '') USER_PWD,
			   NVL(USER_NAME, '') USER_NAME,
			   NVL(USER_PHONE, '') USER_PHONE,
			   NVL(USER_PROFILE, '') USER_PROFILE,
			   NVL(STATUS, 'N') STATUS,
			   NVL(TO_CHAR(REG_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') REG_DATE,
			   NVL(TO_CHAR(UPDATE_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') UPDATE_DATE,
			   NVL(TO_CHAR(LAST_LOGIN_DATE, 'YYYY.MM.DD HH24:MI:SS'), '') LAST_LOGIN_DATE,
			   NVL(USER_EMAIL, '') USER_EMAIL
		  FROM SM_USER
		 WHERE USER_ID = #{value}
	</select>
	<insert id="userJoin" parameterType="com.sist.web.model.User">
		INSERT INTO SM_USER(
			   USER_ID,
			   USER_PWD,
			   USER_NAME,
			   USER_PHONE,
			   USER_EMAIL,
			   STATUS,
			   REG_DATE
		) VALUES(
			   #{userId},
			   #{userPwd},
			   #{userName},
			   #{userPhone},
			   #{userEmail},
			   'Y',
			   SYSDATE
		)
		
	</insert>
	<update id="userLogin" parameterType="String">
		UPDATE SM_USER
		   SET LAST_LOGIN_DATE = SYSDATE
		 WHERE USER_ID = #{value}
	</update>
	<update id="userUpdate" parameterType="com.sist.web.model.User">
		UPDATE SM_USER
		   SET USER_PWD = #{userPwd},
		       USER_NAME = #{userName},
		       USER_PHONE = #{userPhone},
		       USER_EMAIL = #{userEmail},
		       UPDATE_DATE = SYSDATE
		 WHERE USER_ID = #{userId}
	</update>
</mapper>